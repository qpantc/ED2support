#==========================================================================================#
#==========================================================================================#
#     This function creates SpatialPolygons from a group of 4 variables that define the    #
# corners.                                                                                 #
#------------------------------------------------------------------------------------------#
data.frame.2.Spoly <<- function(xa,ya,xz,yz,proj4,ID=seq_along(xa),clockwise=TRUE){
    #----- Create polygons. ---------------------------------------------------------------#
    ans = mapply( FUN      = one.coord.2.Polygon
                , xa       = as.list(xa)
                , xz       = as.list(xz)
                , ya       = as.list(ya)
                , yz       = as.list(yz)
                , MoreArgs = list(clockwise=clockwise)
                , SIMPLIFY = FALSE
                )#end mapply
    #--------------------------------------------------------------------------------------#


    #----- Create Spatial Polygons Data Frame. --------------------------------------------#
    ans = mapply(FUN=Polygons,srl=ans,ID=as.list(ID))
    ans = SpatialPolygons(Srl=ans,proj4string=CRS(proj4))
    #--------------------------------------------------------------------------------------#

    #----- Return answer. -----------------------------------------------------------------#
    return(ans)
    #--------------------------------------------------------------------------------------#
}#end data.frame.2.Spoly
#==========================================================================================#
#==========================================================================================#






#==========================================================================================#
#==========================================================================================#
#     Make a Polygon object from a list of corners.                                        #
#------------------------------------------------------------------------------------------#
one.coord.2.Polygon <<- function(xa,ya,xz,yz,clockwise=TRUE){
   if (clockwise){
      xybounds = rbind(c(xa,ya),c(xa,yz),c(xz,yz),c(xz,ya),c(xa,ya))
   }else{
      xybounds = rbind(c(xa,ya),c(xz,ya),c(xz,yz),c(xa,yz),c(xa,ya))
   }#end (clockwise)
   ans = list(Polygon(xybounds))
   return(ans)
}#end one.coord.2.Polygon
#==========================================================================================#
#==========================================================================================#
